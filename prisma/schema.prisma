generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model users {
  username       String           @id @unique @db.VarChar(50)
  password       String           @db.VarChar(100)
  phoneNumber    String           @db.VarChar(12)
  role           enum_Users_role?
  createdAt      DateTime?        @default(now()) @db.Timestamptz(6)
  updatedAt      DateTime?        @updatedAt @db.Timestamptz(6)
  targetContacts targetContacts[]
  teams          teams[]
  teamUsers      teamUsers[]
}

model targets {
  address        String           @id @unique
  createdAt      DateTime?        @default(now()) @db.Timestamptz(6)
  updatedAt      DateTime?        @updatedAt @db.Timestamptz(6)
  targetContacts targetContacts[]
  teamTarget     teamTarget[]
}

model alertLogs {
  id         Int          @id @default(autoincrement())
  nodeName   String       @db.VarChar(50)
  targetName String       @db.VarChar(50)
  method     enum_method?
  value      Int
  activeAt   DateTime
  createdAt  DateTime?    @default(now()) @db.Timestamptz(6)
  updatedAt  DateTime?    @updatedAt @db.Timestamptz(6)

}

model targetContacts {
  targetAddress String
  username      String  @db.VarChar(50)
  target        targets @relation(fields: [targetAddress], references: [address])
  userContact   users   @relation(fields: [username], references: [username])

  @@id([username, targetAddress])
}

model teams {
  teamName      String       @id @db.VarChar(50)
  teamUsers     teamUsers[]
  users         users?       @relation(fields: [usersUsername], references: [username])
  usersUsername String?      @db.VarChar(50)
  teamTarget    teamTarget[]
}

model teamUsers {
  teamName String @db.VarChar(20)
  username String @db.VarChar(50)
  team     teams  @relation(fields: [teamName], references: [teamName])
  user     users  @relation(fields: [username], references: [username])

  @@id([username, teamName])
}

model teamTarget {
  teamName      String  @db.VarChar(20)
  targetAddress String  @db.VarChar(50)
  team          teams   @relation(fields: [teamName], references: [teamName])
  target        targets @relation(fields: [targetAddress], references: [address])


  @@id([teamName, targetAddress])
}

enum enum_method {
  ping
  http_request
}

enum enum_Users_role {
  ADMIN
  REPORTER
}
